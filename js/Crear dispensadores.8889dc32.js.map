{"version":3,"file":"js/Crear dispensadores.8889dc32.js","mappings":"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","sources":["webpack://solana-i-am-entity/./src/views/dispensers/CreateDispenser.vue","webpack://solana-i-am-entity/./src/views/dispensers/CreateDispenser.vue?fb05"],"sourcesContent":["<template>\n  <div>\n    <div class=\"text-3xl font-bold text-gray-900 tracking-wide\">Crear dispensador</div>\n    <hr class=\"mt-3 dark:border-primary-400 border-t-2 rounded mb-8\" />\n    <div class=\"flex flex-row items-start\">\n      <img class=\"hidden sm:block md:w-1/3 w-1/2 aspect-square bg-cover bg-primary-50 border-primary-100 border-2 mr-4 rounded\" v-if=\"nftLogoPreview\" :src=\"nftLogoPreview\" />\n      <div v-else class=\"hidden md:w-1/3 w-1/2 aspect-square rounded bg-primary-50 mr-4 border-primary-100 border-2 text-sm p-2 text-center sm:flex sm:flex-col place-content-center\">\n        Preview de la colecci√≥n seleccionada\n      </div>\n      <div class=\"flex flex-col grow gap-y-4\">\n        <div class=\"flex flex-wrap gap-x-4 gap-y-6 items-center justify-center w-full\">\n          <img class=\"sm:hidden h-36 w-36 bg-cover bg-primary-50 border-primary-100 border-2 rounded\" v-if=\"nftLogoPreview\" :src=\"nftLogoPreview\" />\n          <div v-else class=\"sm:hidden h-36 w-36 rounded bg-primary-50 border-primary-100 border-2 text-sm justify-center items-center p-2 text-center flex flex-col place-content-center\">\n            Preview de la colecci√≥n seleccionada\n          </div>\n          <!-- No hay nfts para mostrar -->\n          <div class=\"w-full\">\n            <input-label class=\"mb-3\" text=\"Credencial para dispensador\" />\n            <v-select\n              placeholder=\"Seleccionar credencial\"\n              :options=\"nfts\"\n              :reduce=\"(o) => o\"\n              :getOptionLabel=\"(option) => option.name\"\n              :getOptionKey=\"(nft) => (nft.metadataAddress ? nft.metadataAddress.toBase58() : nft.address.toBase58())\"\n              :loading=\"isLoadingNfts && nfts.length == 0\"\n              v-model=\"nftCollection\"\n            />\n          </div>\n        </div>\n        <v-input name=\"itemsAvailable\" label=\"N√∫mero de items disponibles en este dispensador\" placeholder=\"Ingresa el n√∫mero de items disponibles en el dispensador\" />\n        <v-input name=\"price\" label=\"Precio de cada credencial\" placeholder=\"Ingresa el precio en sols para cada credencial\" />\n\n        <div class=\"flex flex-row flex-wrap\">\n          <div class=\"sm:w-1/2 w-full p-1\">\n            <v-cancel-button :disabled=\"isCreating\" @click=\"$router.back()\" class=\"h-10 w-full rounded-md\"> Atras </v-cancel-button>\n          </div>\n          <div class=\"sm:w-1/2 w-full p-1\">\n            <v-primary-button\n              @click=\"createCandyMachine\"\n              :disabled=\"!isValid || isCreating\"\n              class=\"h-10 w-full rounded-md\"\n              color=\"bg-green-400 hover:bg-green-500 focus:ring-green-800 active:bg-green-700\"\n            >\n              {{ !isCreating ? \"Confirmar\" : \"Cargando\" }}\n            </v-primary-button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport { ref } from \"@vue/reactivity\";\nimport { useStore } from \"vuex\";\nimport { computed, onMounted } from \"@vue/runtime-core\";\nimport { useForm } from \"vee-validate\";\nimport { useWorkspace } from \"@/composables\";\nimport { sol, toBigNumber, toDateTime } from \"@metaplex-foundation/js\";\nimport InputLabel from \"@/components/inputs/InputLabel.vue\";\nimport { ADD_CREATED_MACHINE } from \"@/store/connection/types.js\";\nimport { notify } from \"@kyvg/vue3-notification\";\nimport { useRouter } from \"vue-router\";\nimport { PublicKey } from \"@solana/web3.js\";\n\nexport default {\n  components: {\n    InputLabel,\n  },\n  setup() {\n    const { metaplex } = useWorkspace();\n\n    const nftCollection = ref(null);\n    const isLoadingNfts = ref(false);\n    const store = useStore();\n\n    const isCreating = ref(false);\n    const router = useRouter();\n\n    //Const form schema\n    const formSchema = {\n      // nftCollection: \"required\",\n      itemsAvailable: \"required|integer|min_value:1|max_value:100\",\n      price: \"required|min_value:0.01\",\n    };\n    //Form values\n    const { values, meta } = useForm({\n      validationSchema: formSchema,\n    });\n\n    //Computed\n    const nftLogoPreview = computed(() => {\n      if (nftCollection.value) {\n        return nftCollection.value.json.image;\n      }\n      return null;\n    });\n    const nfts = computed(() => store.getters.nftsModels);\n    const isValid = computed(() => meta.value.valid && nftCollection.value);\n    // const isValid = computed(() => true);\n\n    async function fetchNfts() {\n      isLoadingNfts.value = true;\n      await store.dispatch(\"getNftFromCreator\", true);\n      isLoadingNfts.value = false;\n    }\n\n    const createCandyMachine = async () => {\n      isCreating.value = true;\n\n      const _nftCollection = nftCollection.value;\n      const client = await metaplex.value.candyMachinesV2();\n      try {\n        const { data } = await _axios.post(\"/create/dispenser\", {\n          name: _nftCollection.name,\n          price: values.price,\n          itemsAvailable: values.itemsAvailable,\n          address: _nftCollection.address,\n          uri: _nftCollection.uri,\n        });\n        const candyMachineFound = await client.findByAddress({ address: new PublicKey(data.address) });\n\n        store.commit(ADD_CREATED_MACHINE, candyMachineFound);\n\n        notify({\n          type: \"success\",\n          title: \"Se creo exitosamente!\",\n          text: \"Dispensador creado exitosamente\",\n        });\n        router.push(\"/dispensers\");\n      } catch (error) {\n        console.error(error);\n        notify({\n          type: \"error\",\n          title: \"Error al crear el dispensador üç¨\",\n          text: \"Por favor prueba nuevamente crear el dispensador\",\n        });\n      }\n      isCreating.value = false;\n    };\n\n    onMounted(() => {\n      fetchNfts();\n    });\n    return {\n      nfts,\n      isValid,\n      nftLogoPreview,\n      createCandyMachine,\n      isCreating,\n      isLoadingNfts,\n      nftCollection,\n    };\n  },\n};\n</script>","import { render } from \"./CreateDispenser.vue?vue&type=template&id=74028a61\"\nimport script from \"./CreateDispenser.vue?vue&type=script&lang=js\"\nexport * from \"./CreateDispenser.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/Users/augustoalonso/vue/solana-i-am-entity/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","src","nftLogoPreview","text","placeholder","options","nfts","reduce","o","getOptionLabel","option","name","getOptionKey","nft","metadataAddress","toBase58","address","loading","isLoadingNfts","length","nftCollection","label","disabled","isCreating","$router","back","createCandyMachine","isValid","color","components","InputLabel","setup","metaplex","store","router","formSchema","itemsAvailable","price","values","meta","validationSchema","value","json","image","getters","nftsModels","valid","async","fetchNfts","dispatch","_nftCollection","client","candyMachinesV2","data","_axios","post","uri","candyMachineFound","findByAddress","commit","type","title","push","error","console","__exports__","render"],"sourceRoot":""}